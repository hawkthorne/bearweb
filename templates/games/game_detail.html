{% extends "base.html" %}

{% load core_extras %}

{% block title %}{{ object.name }}{% endblock %}

{% block content %}
<div class="row">
  <div class="col-sm-12">
    {% include "games/gamebar.html" %}
    <div id="total-game-opens"></div>
    <div id="unique-game-opens"></div>
  </div>
</div>
<script type="text/javascript">
  var Keen=Keen||{configure:function(e){this._cf=e},addEvent:function(e,t,n,i){this._eq=this._eq||[],this._eq.push([e,t,n,i])},setGlobalProperties:function(e){this._gp=e},onChartsReady:function(e){this._ocrq=this._ocrq||[],this._ocrq.push(e)}};(function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://":"http://")+"dc8na2hxrj29i.cloudfront.net/code/keen-2.1.0-min.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();

  // Configure the Keen object with your Project ID and (optional) access keys.
  Keen.configure({
    projectId: "{{KEEN_PROJECT_ID}}",
    readKey: "{{KEEN_READ_KEY}}"    // required for doing analysis
  });
</script>
<script type="text/javascript">
  Keen.onChartsReady(function() {
    var unique = new Keen.Series("opens", {
        analysisType: "count_unique",
        targetProperty: "distinct_id",
        timeframe: "this_7_days",
        interval: "daily"
    });

    unique.addFilter("game_id", "eq", {{game.pk}});

    unique.draw(document.getElementById("unique-game-opens"), {
        title: "Unique game opens per day for last 7 Days",
        label: "opens"
    });

    var total = new Keen.Series("opens", {
        analysisType: "count",
        timeframe: "this_7_days",
        interval: "daily"
    });

    total.addFilter("game_id", "eq", {{game.pk}});

    total.draw(document.getElementById("total-game-opens"), {
        title: "Total game opens per day for last 7 Days",
        label: "opens"
    });

});
</script>
{% endblock %}


